# -*- coding: utf-8 -*-
"""
Created on Mon Apr 26 14:12:56 2021

@author: iant

FUDGE FOR 2016 LNO LINESCAN
"""


import numpy as np
import matplotlib.pyplot as plt
import spiceypy as sp



from tools.file.paths import FIG_X, FIG_Y
from tools.file.hdf5_functions import open_hdf5_file, get_files_from_datastore

from tools.spice.load_spice_kernels import load_spice_kernels
from tools.spice.datetime_functions import utc2et

load_spice_kernels()


"""user modifiable"""
MESHGRID = False
# MESHGRID = True

# channel = "so"
channel = "lno"
"""end"""



SPICE_ABERRATION_CORRECTION = "None"
SPICE_OBSERVER = "-143"

DETECTOR_CENTRE_LINES = {"so":128, "lno":152}




linescan_dict = {
        "so":{
#            "MCO-1":["20161120_231420_0p1a_SO_1", "20161121_012420_0p1a_SO_1"],
            "Old SO boresight (Apr 2018)":["20180428_023343_0p1a_SO_1", "20180511_084630_0p1a_SO_1"],
            "UVIS-prime (Aug 2018)":["20180821_193241_0p1a_SO_1", "20180828_223824_0p1a_SO_1"],
            "UVIS-prime (Dec 2018)":["20181219_091740_0p1a_SO_1", "20181225_025140_0p1a_SO_1"], #not a nomad linescan
            "UVIS-prime (Jan 2019)":["20190118_183336_0p1a_SO_1", "20190125_061434_0p1a_SO_1"],
            "SO-prime (Oct 2019)":["20191022_013944_0p1a_SO_1", "20191028_003815_0p1a_SO_1"],
            "SO-prime (Feb 2020)":["20200226_024225_0p1a_SO_1", "20200227_041530_0p1a_SO_1"],
            "SO-prime (Dec 2020)":["20201224_011635_0p1a_SO_1", "20210102_092937_0p1a_SO_1"],
        },
         "lno":{
            "Old LNO boresight (June 2016)":["20160615_233950_0p1a_LNO_1", "20160616_015450_0p1a_LNO_1"], \
            # "Old LNO boresight (Nov 2016)":["20161121_000420_0p1a_LNO_1", "20161121_021920_0p1a_LNO_1"], \
            # "MTP001":["201905", "20190704"],
            # "MTP015":["", ""],
            # "SO-prime (Jul 2020)":["20200724_125331_0p1a_LNO_1", "20200728_144718_0p1a_LNO_1"],
        },
}


#    referenceFrame = "TGO_NOMAD_UVIS_OCC"
# referenceFrame = "TGO_NOMAD_SO"
referenceFrame = "TGO_NOMAD_LNO_OPS_OCC"
# referenceFrame = "TGO_SPACECRAFT"


def get_vector_text(filename):
    if filename == "20160615_233950_0p1a_LNO_1":
        return [[0.0211061589117828, -0.00635578675464921, -0.999757037499972], 
[0.0192372464287813, -0.00635539169963261, -0.999794747608819], 
[0.0173467284219969, -0.00635360702189612, -0.999829346784172], 
[0.015390768809818, -0.00635481476935951, -0.999861360671913], 
[0.0134308073622218, -0.00635582041102301, -0.999889602386434], 
[0.0114818328987166, -0.00635769093783362, -0.999913869930418], 
[0.00954224036416268, -0.00636276354259876, -0.999934228281507], 
[0.00759695288909213, -0.00636279415050523, -0.999950899373264], 
[0.00565088978763183, -0.00635799549739758, -0.999963821014472], 
[0.00370977781948812, -0.00636050771931146, -0.999972890377576], 
[0.00176586694792219, -0.00636556908584609, -0.99997818038402], 
[-0.000174538118514312, -0.00636595598346657, -0.999979721864829], 
[-0.0021109108339893, -0.00636662565175751, -0.999977504813614], 
[-0.00404837794129115, -0.00636681584025254, -0.999971536740972], 
[-0.00598586268399891, -0.00636770939509823, -0.999961810133261], 
[-0.00793504218434336, -0.00636881474286349, -0.99994823531236], 
[-0.00986855577697923, -0.00637231795607272, -0.999931000204886], 
[-0.0118132850547398, -0.00637556879364788, -0.999909895149945], 
[-0.0137518253391357, -0.00637598869384005, -0.999885110434203], 
[-0.0156859100225718, -0.00637477810622058, -0.99985664694038], 
[-0.0176205009628309, -0.00637456152803831, -0.999824426042465], 
[-0.0195654711779124, -0.00637739887990917, -0.999788238139014], 
[-0.0214877691678958, -0.00637662642632302, -0.999748775648966], 
[-0.0232447860752188, -0.00633633969118569, -0.999709723229516], 
[-0.024625330312756, -0.00620232345588697, -0.999677510145515], 
[-0.0256502144376693, -0.0059995358537727, -0.99965297582153], 
[-0.0263613413020217, -0.00575978682571981, -0.999635885980731], 
[-0.0267488551811422, -0.00550129938142798, -0.99962704767909], 
[-0.0267849486094647, -0.00524129296680059, -0.999627478301805], 
[-0.0264672441052258, -0.00498588292861715, -0.999637247185646], 
[-0.0258105271666873, -0.00475098626067597, -0.999655563090072], 
[-0.0248113546816175, -0.00455669132620059, -0.999681765985066], 
[-0.023459038805021, -0.00441587333355451, -0.999715046181184], 
[-0.0217637105607939, -0.00435548866137219, -0.999753654967636], 
[-0.0198509854264716, -0.00434520422956214, -0.999793507469318], 
[-0.0179478327091685, -0.0043364771312444, -0.999829520601954], 
[-0.0160202813459072, -0.00433126597272782, -0.999862285877746], 
[-0.0140732037517595, -0.0043310754145441, -0.999891587484321], 
[-0.0121266743791357, -0.00433054405750596, -0.999917091641436], 
[-0.0101794409850651, -0.00432820702211726, -0.999938820931163], 
[-0.00824668625813937, -0.00432824355970703, -0.999956628296172], 
[-0.00630202775376072, -0.0043276321538101, -0.999970777596092], 
[-0.00435784412612215, -0.00432786073030008, -0.999981139230172], 
[-0.00241448613140969, -0.00432715351486236, -0.999987722924227], 
[-0.000471797692147805, -0.0043269036993746, -0.999990527610794], 
[0.00146927604703686, -0.00432137385182453, -0.999989583423713], 
[0.00340897847109655, -0.00432106603795856, -0.999984853512332], 
[0.00534798146122142, -0.00432155751157175, -0.999976361338089], 
[0.00729018901298627, -0.00432149661501975, -0.999964088260754], 
[0.00922564608168588, -0.00432334415125142, -0.999948096727888], 
[0.0111661703016256, -0.00432190620985266, -0.999928316314479], 
[0.0131067189257362, -0.00431949774932302, -0.999904773395045], 
[0.0150459261424927, -0.00432045576707962, -0.999877469377363], 
[0.0169816547489322, -0.00431756325917195, -0.999846479240434], 
[0.0189181963510837, -0.00431395644977144, -0.99981172809013], 
[0.0208617485034821, -0.00432001342370163, -0.999773036710531], 
[0.0227648691599087, -0.00430925689077188, -0.999731559488437], 
[0.0244087525022928, -0.00423494230791278, -0.999693091936185], 
[0.0256960289640492, -0.00407740529446456, -0.999661487135292], 
[0.026675457899136, -0.0038775748091093, -0.999636626159462], 
[0.027310881267168, -0.00364090595838055, -0.999620357719976], 
[0.0276091880262544, -0.00338027560800326, -0.999613078382503], 
[0.0275584996510652, -0.00311406706368463, -0.999615341860711], 
[0.0271605012577749, -0.00286083371053307, -0.999626991833407], 
[0.026413219691576, -0.00263765140181659, -0.999647630228075], 
[0.0253251946881103, -0.00245732217197119, -0.999676245632431], 
[0.0238819116940363, -0.00233975655851582, -0.999712048458497], 
[0.022105878772613, -0.0022986915562297, -0.999752992564073], 
[0.0201753266270618, -0.0022984417045183, -0.999793815424572], 
[0.0182749165062703, -0.00228929897544402, -0.999830378882783], 
[0.0163424031967853, -0.0022843641460241, -0.999863844499941], 
[0.014399660241982, -0.00227950590613331, -0.999893721171275], 
[0.0124565089344655, -0.00227993029742747, -0.99991981543672], 
[0.010511766629297, -0.00228651035358707, -0.999942135642225], 
[0.00856859261272886, -0.00228325091905685, -0.999960682219995], 
[0.00662323286870886, -0.00228406775038797, -0.999975457609275], 
[0.00468587079479741, -0.002287782996452, -0.999986404239505], 
[0.00274280695350373, -0.00229079159151037, -0.999993614621563], 
[0.000801657515525681, -0.00229438877172106, -0.999997046558335], 
[-0.00113394391918849, -0.00229560687069529, -0.99999672217477], 
[-0.00307041753626141, -0.00229566435155184, -0.999992651203667], 
[-0.00501082297728852, -0.00230066664923531, -0.999984799177497], 
[-0.00694979520055628, -0.00230638287590853, -0.999973190112965], 
[-0.00888927438933232, -0.00230553119856176, -0.999957831774282], 
[-0.0108344378501406, -0.00230101736111879, -0.999938658256383], 
[-0.0127759977239719, -0.00229828552865641, -0.999915742333216], 
[-0.0147169104370379, -0.00229872870033564, -0.999889058042716], 
[-0.0166490808789936, -0.00230150699209918, -0.999858745609324], 
[-0.0185987145340823, -0.00230379396812069, -0.999824374753402], 
[-0.0205450790480465, -0.00230744401868249, -0.999786264873153], 
[-0.0224118592315215, -0.0022898453214229, -0.999746200379972], 
[-0.0239503288688409, -0.00218748762387538, -0.999710756491581], 
[-0.0251517945441009, -0.00201328158010882, -0.999681616280149], 
[-0.026054151171221, -0.00179969588942693, -0.999658912980549], 
[-0.0266070322648329, -0.00156232279694895, -0.99964474938927], 
[-0.0268163411381422, -0.00130526838050922, -0.999639525090128], 
[-0.0266745366778332, -0.00104210918811603, -0.999643628050248], 
[-0.0261849959468125, -0.000795099432320718, -0.999656798008275], 
[-0.0253539380356116, -0.000576487143524168, -0.99967837102173], 
[-0.0241823618103228, -0.000404810803717225, -0.999707481969345], 
[-0.0226573523536138, -0.000305927618927583, -0.999743242434084], 
[-0.0208227630877408, -0.000282664146462492, -0.999783142805665], 
[-0.0189010680993095, -0.000283505936532075, -0.999821318661034], 
[-0.0169915472864992, -0.000269375053241001, -0.999855596952826], 
[-0.0150536909885897, -0.000259015374648018, -0.999886653225582], 
[-0.0131092334466556, -0.000257551755653823, -0.99991403713796], 
[-0.0111598818923248, -0.000254317121070238, -0.999937694238472], 
[-0.00921751722884543, -0.000250692862420898, -0.999957486360908], 
[-0.00727637698664362, -0.000255280166427333, -0.999973494233715], 
[-0.00533192510634045, -0.000254558427917556, -0.999985752785842], 
[-0.00338603289317287, -0.000251935779078506, -0.999994235638191], 
[-0.00144485245160299, -0.000253613715009915, -0.999998924040159], 
[0.000497457138951963, -0.000252822868402264, -0.999999844308484], 
[0.00243573421302457, -0.000250464228111573, -0.999997002228764], 
[0.00436745658475566, -0.000248989649740245, -0.99999043161779], 
[0.00630773241365322, -0.000246070787981831, -0.999980075781995], 
[0.0082548016342118, -0.000246951514867152, -0.999965898050993], 
[0.0101934721648855, -0.000245276426826442, -0.999948015131136], 
[0.0121346918149742, -0.000245958427678819, -0.999926341666729], 
[0.0140697487136813, -0.000248368729427378, -0.999900985340103], 
[0.0160036277130149, -0.000249355221448443, -0.999871902656534], 
[0.0179388269194667, -0.00024848767691225, -0.999839055419735], 
[0.0198934564130177, -0.000244225979402108, -0.99980207578581], 
[0.0218307340557739, -0.00024060242664727, -0.999761652175687], 
[0.0236410844521495, -0.000208374703155659, -0.999720488789696], 
[0.025081304069329, -9.48024888515809E-05, -0.999685410115937], 
[0.0262112303020673, 9.06247488570486E-05, -0.99965642257388], 
[0.0270328384828913, 0.000309600432762333, -0.999634498099745], 
[0.0275011823785078, 0.00055406515143233, -0.999621617403101], 
[0.0276187342418607, 0.000818083141254343, -0.999618195241989], 
[0.0274010438206611, 0.00108301748793577, -0.999623934222595], 
[0.0268244348346535, 0.00132670662757335, -0.9996392797131], 
[0.0259046395390256, 0.00153083135136257, -0.99966324640137], 
[0.0246440964538854, 0.00168196387285477, -0.99969487320257], 
[0.0230178441130864, 0.00175743607077358, -0.999733509626862], 
[0.0211440607340565, 0.00177129562106648, -0.999774870262049], 
[0.0192304903584103, 0.00178041283665938, -0.999813491792697], 
[0.0173133997132944, 0.00179200918522465, -0.999848505971504], 
[0.0153727670064801, 0.00179492624188972, -0.999880220963666], 
[0.0134249744180882, 0.00179469508206951, -0.999908270358554], 
[0.0114838035357691, 0.00178977976153592, -0.999932457191363], 
[0.00953969908384064, 0.00178703339006354, -0.999952899217284], 
[0.00760191163944493, 0.00178401470308398, -0.999969513650774], 
[0.00566165525200025, 0.00178280456078189, -0.999982383478682], 
[0.00371873292435105, 0.00178064440172234, -0.999991500129352], 
[0.0017746236766199, 0.00177915905964407, -0.999996842646939], 
[-0.000172619448339497, 0.00177881398778204, -0.999998403010386], 
[-0.00211182086029235, 0.00177765521268805, -0.999996190070042], 
[-0.00404759059682268, 0.00178027804308583, -0.999990223762438], 
[-0.00598185257448106, 0.00177943033716893, -0.999980525344095], 
[-0.00792077810718689, 0.00177534385894791, -0.999967054171466], 
[-0.00986249530010115, 0.00177335931104637, -0.99994979193118], 
[-0.0118073128081786, 0.00177000426146383, -0.999928724684497], 
[-0.0137424035208885, 0.00176944356311783, -0.999904003099771], 
[-0.0156814665598407, 0.00176881138731549, -0.999875473703005], 
[-0.0176243809246913, 0.00177203602545498, -0.99984310823516], 
[-0.0195737341631743, 0.00176568104219453, -0.999806856998574], 
[-0.0214979861085636, 0.00176730974642889, -0.999767329536996], 
[-0.0232367701628018, 0.00182288602833916, -0.999728327896598], 
[-0.02459082258529, 0.0019608011847967, -0.999695677045416], 
[-0.0256451613709738, 0.00215681778971924, -0.999668782064979], 
[-0.0263694697190997, 0.00238639099172053, -0.999649416648041], 
[-0.0267601280854468, 0.00264407468981887, -0.999638386824898], 
[-0.026766933915461, 0.00290191991603295, -0.999637489347797], 
[-0.0264872018825719, 0.00315490032408365, -0.99964417406414], 
[-0.025823702518361, 0.00338446150665348, -0.999660783370316], 
[-0.0248148772163512, 0.00358050439475294, -0.999685651521025], 
[-0.0234678045616413, 0.00372157977511597, -0.999717666140313], 
[-0.0217670868295894, 0.003787617608508, -0.999755894148069], 
[-0.0198546120796348, 0.00379881190728565, -0.999795660826381], 
[-0.0179490882710015, 0.00380275542763805, -0.999831670473284], 
[-0.0160264763342045, 0.00380831315835663, -0.999864315198416], 
[-0.0140880271035433, 0.00381134962956434, -0.999893494881495], 
[-0.0121426264770561, 0.00381258755238357, -0.999919007119274], 
[-0.0101942473585039, 0.00381194472501443, -0.999940771445093], 
[-0.0082492200196138, 0.00381281868489593, -0.999958705538756], 
[-0.00630792712210322, 0.00381442513708546, -0.999972829739036], 
[-0.00436630121744884, 0.00381762985223696, -0.999983180416546], 
[-0.00242056047174387, 0.00381599938087328, -0.999989789465736], 
[-0.000475430573423917, 0.00381404760759697, -0.999992613476028], 
[0.00146503235801541, 0.00381621163709485, -0.999991645069563], 
[0.00339837893231163, 0.00382659472604348, -0.999986904010965], 
[0.00533569418281157, 0.00382855752166962, -0.999978436024943], 
[0.00727831790886515, 0.00382621334902632, -0.99996619251844], 
[0.00922182028362406, 0.00382499170477447, -0.999950162492669], 
[0.0111645021510774, 0.0038239856148164, -0.999930363088218], 
[0.0131005343862953, 0.00382584306151391, -0.999906865124779], 
[0.0150374088898677, 0.00382894829210085, -0.999879600496408], 
[0.0169703010286498, 0.00383323423573138, -0.999848646145151], 
[0.0189087273492776, 0.00383655127869328, -0.999813853126829], 
[0.0208614782713896, 0.00383345264358779, -0.999775026376015], 
[0.0227581293410567, 0.00383873845959686, -0.99973363034157], 
[0.0243996432305138, 0.00390690690607782, -0.999694650125052], 
[0.0256873707379461, 0.00406079566024264, -0.999661777264279], 
[0.0266539936890556, 0.004264699728225, -0.999635622092696], 
[0.0273067415881532, 0.00450103070059952, -0.999616967936454], 
[0.027601990365443, 0.00475840715327833, -0.999607666881977], 
[0.0275558692907436, 0.00502522016650457, -0.999607633639274], 
[0.0271524356965126, 0.00528290444872464, -0.99961734486569], 
[0.0264057085898099, 0.00551389933172233, -0.999636101522964], 
[0.0253137887348156, 0.00569827436415314, -0.999663314205918], 
[0.0238685751889706, 0.00580866865553681, -0.999698229710796], 
[0.0220992528219696, 0.00584494198805194, -0.999738695698965], 
[0.020175507913961, 0.00584700913104251, -0.999779356340505], 
[0.0182711201263949, 0.00585489019236342, -0.999815926273513], 
[0.0163286550672164, 0.00586064621155312, -0.999849502600106], 
[0.0143918550023659, 0.00586420908029864, -0.999879235488693], 
[0.0124515925963993, 0.00586423985557534, -0.999905279780405], 
[0.0105120059622995, 0.00585920772354991, -0.999927581085501], 
[0.00856916746176301, 0.00585654244166738, -0.999946133689031], 
[0.00663223004285209, 0.00585496632845036, -0.999960865681228], 
[0.00469109123645334, 0.00585294508305316, -0.999971867952727], 
[0.00274996554506911, 0.00585055829777821, -0.999979104110233], 
[0.000808623527194018, 0.00585184420463775, -0.999982550871462], 
[-0.00113073462466275, 0.00585433365660806, -0.999982223950329], 
[-0.00307672763184534, 0.00585253341700689, -0.999978140560923], 
[-0.00501849646696267, 0.00585049447535571, -0.999970292762543], 
[-0.00695901535729309, 0.00584820127326923, -0.999958684470076], 
[-0.00889295524893281, 0.00584592594419414, -0.999943368644842], 
[-0.0108332947635907, 0.00584663991959713, -0.999924225392212], 
[-0.012775488371761, 0.00584565586277194, -0.999901302731623], 
[-0.014720625448971, 0.005844597475208, -0.999874564066285], 
[-0.0166587570527534, 0.00584834514511561, -0.999844129188405], 
[-0.0185995682528956, 0.00584378619342785, -0.999809935049523], 
[-0.0205393942857951, 0.00584264685016305, -0.999771972381781], 
[-0.0224038454812053, 0.00583914372530578, -0.999731950128738], 
[-0.0238135209014982, 0.00584106708568905, -0.999699353884744], 
[-0.0247453120536855, 0.00583983535247502, -0.999676730675683], 
[-0.0253400825081614, 0.005839071826417, -0.999661835551746], 
[-0.0256297847590169, 0.00584071467139243, -0.999654440386944], 
[-0.0256456997093592, 0.00584079856065069, -0.999654031732275], 
[-0.0254233325675561, 0.00584245363324476, -0.999659702047003], 
[-0.0250133425545318, 0.00583881812361965, -0.999670066020369], 
[-0.0244825883450028, 0.00583524487500667, -0.999683226219775], 
[-0.0238775353435053, 0.00583268314550366, -0.999697875917141], 
[-0.0232434442541648, 0.00583377836042695, -0.999712813426558], 
[-0.0226354556672992, 0.0058392612120272, -0.999726732249984], 
[-0.0220973791152276, 0.00584082399842341, -0.999738761182769], 
[-0.0217339570445757, 0.00584015433483431, -0.99974673178187], 
[-0.0215039141251059, 0.00583790959765567, -0.999751719422792], 
[-0.0214536356157889, 0.00583716592463294, -0.999752803953474], 
[-0.0214252484802958, 0.00584324997390123, -0.999753377167239], 
[-0.0213742486948472, 0.00584523886211514, -0.999754457192052], 
[-0.0213803855810502, 0.00584167882027886, -0.99975434677773], 
[-0.0214031530845868, 0.00583862599584269, -0.999753877454105], 
[-0.0214132560663981, 0.00584260155754132, -0.999753637888693], 
[-0.0214120877219992, 0.00584432512853424, -0.999753652838127], 
[-0.0214165249809447, 0.00584328244857465, -0.999753563888605], 
[-0.0214240587259823, 0.00584643151262812, -0.999753384063427], 
[-0.0214267988972191, 0.00584471946782238, -0.999753335349956], 
[-0.0214224757781471, 0.00584183629408703, -0.999753444845402], 
[-0.0214239580627607, 0.00584109363543951, -0.999753417421549], 
[-0.0214290548848645, 0.00584270810657037, -0.999753298753609], 
[-0.0214264332000421, 0.00584501097338337, -0.999753341483311], 
[-0.0214248457417111, 0.00584247241306451, -0.999753390342362], 
[-0.0214196605953404, 0.00583799533942324, -0.999753527600877], 
[-0.021411398800278, 0.00583531246565679, -0.999753720238061], 
[-0.0214070222630652, 0.00583496579978861, -0.999753815982687], 
[-0.0214000137095807, 0.00583216081322195, -0.999753982394408], 
[-0.0213898711919828, 0.00582931343319698, -0.99975421605277], 
[-0.0213829386792015, 0.00582653535326512, -0.999754380545151], 
[-0.0213756241366624, 0.00582289863790857, -0.99975455815126], 
]
    elif filename == "20160616_015450_0p1a_LNO_1":
        return [[0.00652986067028348, -0.0209371368489712, -0.99975946968268], 
[0.00653024370455825, -0.0190502429787473, -0.999797201516192], 
[0.00652446876752616, -0.0171769235791782, -0.999831178051403], 
[0.00652131802642047, -0.0152524414145438, -0.999862408255303], 
[0.00652079138867727, -0.0132981169798112, -0.999890313666682], 
[0.00652532517721056, -0.0113412544492575, -0.999914394375263], 
[0.00652269160747096, -0.0094012018186465, -0.999934533806368], 
[0.0065167216265678, -0.00745736404815516, -0.999950958827829], 
[0.00651098869626822, -0.00551138168432601, -0.999963615187136], 
[0.00650937792028607, -0.00356489842698856, -0.999972459369905], 
[0.00651335755027625, -0.00161913230597341, -0.999977477038357], 
[0.00651108455645072, 0.00031892074535774, -0.999978751807986], 
[0.006505529372729, 0.00225702742267705, -0.999976291676355], 
[0.00650633097707973, 0.00419898293274191, -0.999970017650303], 
[0.00650668385165686, 0.00613903922801116, -0.999959986830779], 
[0.00650698488156172, 0.00808372638625217, -0.999946154808079], 
[0.00650689412660126, 0.0100249013607394, -0.999928578290236], 
[0.00650472410010984, 0.0119668061627779, -0.999907237754905], 
[0.00649808262807033, 0.0138977355967544, -0.999882307007901], 
[0.0064996999647947, 0.015827862643398, -0.999853605616597], 
[0.0065037599956291, 0.0177642354539017, -0.999821050510869], 
[0.00649923892760383, 0.019713441161331, -0.999784546855441], 
[0.00649326998228933, 0.0216392731638671, -0.999744757076463], 
[0.00644609705126332, 0.0233996694312982, -0.999705408259509], 
[0.00631068804308439, 0.0247901650009098, -0.999672757924137], 
[0.00611865800946172, 0.0258096343381919, -0.999648150500711], 
[0.0058783088805815, 0.0265025488014206, -0.999631462285843], 
[0.00561991087880671, 0.0268800790712359, -0.999622867861094], 
[0.00536345672416801, 0.0269175689830487, -0.999623267942484], 
[0.00510258800832837, 0.026604586759501, -0.999633012439552], 
[0.00485953772805837, 0.0259439768240299, -0.999651586783927], 
[0.00466220304130413, 0.0249468553170433, -0.999677907264431], 
[0.00452957301008283, 0.0235990832349355, -0.999711241428652], 
[0.00446911179877808, 0.0219049471463978, -0.999750068932352], 
[0.00446796396060854, 0.0199928780790263, -0.999790139041271], 
[0.00446489401576407, 0.0180834628331009, -0.999826511497566], 
[0.00446062377923726, 0.0161679263439803, -0.999859340604085], 
[0.00446494907400713, 0.0142402204017403, -0.999888633975142], 
[0.00446820582410728, 0.0122987404826123, -0.999914384394611], 
[0.00447054156197933, 0.0103527532115042, -0.999936415358039], 
[0.00446884602306394, 0.00840807675247907, -0.999954665802679], 
[0.00447007949342219, 0.00646274914773818, -0.99996912515476], 
[0.00447820149169905, 0.00452240575608199, -0.999979746573688], 
[0.00448285024914943, 0.0025817192532378, -0.999986619300149], 
[0.00448412467659625, 0.000638381810297065, -0.999989742494666], 
[0.00448234627938215, -0.00130306246491536, -0.999989105240674], 
[0.00447958512826294, -0.00323962763538174, -0.999984718948176], 
[0.00448327815331593, -0.00517757275491293, -0.999976546203643], 
[0.00448117539479383, -0.00711996691808833, -0.999964611942926], 
[0.00449034882803416, -0.009062677157719, -0.99994885101696], 
[0.00449518242304915, -0.0110034519567382, -0.999929356194736], 
[0.00449097276947838, -0.0129428224262609, -0.999906152851969], 
[0.00449027423420773, -0.0148788785210108, -0.999879220911835], 
[0.00448570865435144, -0.0168145827628211, -0.999848562645554], 
[0.0044852732693341, -0.0187538807320574, -0.999814069855584], 
[0.00449292435082629, -0.0207061495623172, -0.999775509302504], 
[0.00449490610674687, -0.0226110636322809, -0.999734232494071], 
[0.0044178266197365, -0.0242566514754759, -0.999696002626376], 
[0.00425880396538192, -0.0255290854344968, -0.999665008083039], 
[0.00405656097584435, -0.0264895479472413, -0.999640859590383], 
[0.00382214166936276, -0.0271273898859279, -0.999624677542044], 
[0.0035715664262446, -0.0274312709509579, -0.999617311418364], 
[0.00330191234242241, -0.0273883854306993, -0.999619414436506], 
[0.003043134305185, -0.0269885568905587, -0.999631110525561], 
[0.00281667171030209, -0.0262463795332056, -0.999651536247444], 
[0.00263098166625873, -0.0251623799010765, -0.999679915059408], 
[0.0025133379096789, -0.0237252419712924, -0.999715357502302], 
[0.00247320041862903, -0.021956882892921, -0.999755859484362], 
[0.00246997613270293, -0.0200257828929585, -0.999796412894859], 
[0.00245314465718224, -0.0181196227026475, -0.999832816702075], 
[0.00244397528193518, -0.0161979500898107, -0.999865817696409], 
[0.00243809877207071, -0.014265908408621, -0.999895264281042], 
[0.00244590120424309, -0.0123212303082285, -0.999921099312836], 
[0.0024457363091086, -0.0103743495808786, -0.99994319400888], 
[0.00244190565706736, -0.00843034875618264, -0.999961482416503], 
[0.00244416583332757, -0.00648568072679525, -0.999975980710981], 
[0.00244010200963261, -0.00454164500770796, -0.999986709593086], 
[0.00244091194012598, -0.00259953645925109, -0.999993642159338], 
[0.0024375525665846, -0.000661229311120037, -0.999996810551555], 
[0.00243747661013505, 0.00127846023210741, -0.999996212116431], 
[0.00243623835581801, 0.00321629675243638, -0.999991860055808], 
[0.00243378711336203, 0.00515237449013126, -0.999983764726908], 
[0.00243396984423563, 0.00709114362484346, -0.999971895341509], 
[0.00243188519546595, 0.00903375260397315, -0.999956237666572], 
[0.00242583958696825, 0.0109771730193923, -0.99993680649069], 
[0.00242103271455387, 0.012920630945384, -0.999913594215304], 
[0.00242210672865707, 0.014854759489339, -0.999886728344521], 
[0.00242303067069557, 0.0167903811110767, -0.999856095658027], 
[0.00242285906412823, 0.0187358847389561, -0.999821532263135], 
[0.00242236241154477, 0.0206850965334936, -0.999783105949359], 
[0.00240299294416417, 0.0225515118132651, -0.999742794392561], 
[0.0023032205961452, 0.0240954004127768, -0.999707010505495], 
[0.00213749951272061, 0.0252797545618368, -0.999678130752657], 
[0.00192882295312911, 0.0261666443884623, -0.999655733922166], 
[0.00168681484952371, 0.026725810193901, -0.999641378557902], 
[0.00142272947815695, 0.0269427292508339, -0.999635966330418], 
[0.00115461229061613, 0.0267722736241704, -0.999640891638318], 
[0.00090296017225597, 0.0263189709883037, -0.999653188075266], 
[0.000687590759168437, 0.0254925765078958, -0.999674774995317], 
[0.000520669870633464, 0.0243202987839711, -0.9997040822013], 
[0.000421190698110907, 0.02279140079483, -0.999740153564017], 
[0.000395528480035195, 0.0209573596946959, -0.999780292180161], 
[0.000394582053148137, 0.0190316355760537, -0.999818804160186], 
[0.000389107471161521, 0.0171247666603077, -0.999853284718416], 
[0.000388969995761294, 0.0151981946139978, -0.999884425112631], 
[0.000389489575313048, 0.0132663770469346, -0.999911921890083], 
[0.000393466619763183, 0.0113291085037608, -0.999935746177988], 
[0.000400603434051553, 0.00938379464858713, -0.999955890984638], 
[0.00040144909945401, 0.00744060604667657, -0.999972237724767], 
[0.000401771748087779, 0.00549605160553992, -0.999984815882827], 
[0.000410452877210299, 0.00355390507576876, -0.999993600623098], 
[0.000412716382758655, 0.00161069232744979, -0.999998617666751], 
[0.000413129830645377, -0.000331755515851976, -0.999999859631], 
[0.000412020544327024, -0.00227344532322665, -0.999997330839154], 
[0.000410833349769639, -0.00420937540281653, -0.999991056147342], 
[0.00040730448870143, -0.00614832038850528, -0.99998101594953], 
[0.000410361460192467, -0.00808871964272989, -0.999967201571138], 
[0.000416576250758819, -0.0100307388355192, -0.999949604101447], 
[0.000420004412496497, -0.0119779699065359, -0.999928173337071], 
[0.000414771854392747, -0.0139176535783132, -0.999903058742788], 
[0.000414330455577679, -0.0158540998496579, -0.999874230015071], 
[0.000415443698158503, -0.0177887660211724, -0.999841681072548], 
[0.000423461159245359, -0.0197363223374348, -0.999805130143489], 
[0.000424660051232274, -0.02167437747867, -0.999764992898208], 
[0.000388715563911775, -0.0234913379454915, -0.999723964873175], 
[0.000265696646049417, -0.024932714976558, -0.999689096234019], 
[7.95855235921091E-05, -0.0259669312027571, -0.999662799222846], 
[-0.000126877228719103, -0.0268511410194069, -0.999639435060525], 
[-0.000374284422952611, -0.027328068944308, -0.999626448509115], 
[-0.000632773920860782, -0.027455948833424, -0.999622814100809], 
[-0.000892335373577196, -0.0272292738262406, -0.99962881630357], 
[-0.00114419508941654, -0.026655190989271, -0.999644032449013], 
[-0.00135575883111864, -0.0257408150379191, -0.999667730978236], 
[-0.00151170405456476, -0.0244836272534348, -0.999699088099697], 
[-0.00158643548455493, -0.0228684426614351, -0.9997372242508], 
[-0.00160607569479683, -0.0209858858589999, -0.999778482022681], 
[-0.00160939670631242, -0.0190676367467119, -0.999816900772905], 
[-0.0016186334251588, -0.0171590554895568, -0.99985146238856], 
[-0.00162074553806466, -0.0152291237240609, -0.999882716609552], 
[-0.00162079217793351, -0.0132930521489912, -0.999910329878275], 
[-0.00162706066365274, -0.0113493107840809, -0.999934270748994], 
[-0.00162937027585763, -0.00940603817276663, -0.999954434761103], 
[-0.00163178566385223, -0.00746580193571967, -0.999970799112156], 
[-0.00163542706486033, -0.005521832567874, -0.99998341723421], 
[-0.00163353667031585, -0.00358008671255769, -0.999992257238563], 
[-0.00163484397833234, -0.00163781690102743, -0.999997322416898], 
[-0.00163516094882635, 0.000301394849016931, -0.999998617703953], 
[-0.00163543287362958, 0.00224231347819433, -0.999996148687374], 
[-0.00164186785588619, 0.00417959762605129, -0.999989917565986], 
[-0.00163875087171518, 0.00611848225221953, -0.999979939134036], 
[-0.00164370439467105, 0.00806483560529643, -0.999966127757597], 
[-0.00164192535554201, 0.010004824132068, -0.999948602466753], 
[-0.0016420748336139, 0.0119474618792211, -0.999927278228215], 
[-0.00164043488443878, 0.0138845838871137, -0.999902258875172], 
[-0.00164728946787931, 0.0158179907506757, -0.999873530805782], 
[-0.00164871808480593, 0.0177569840965205, -0.999840972977439], 
[-0.001648518461515, 0.0197065092995759, -0.999804448818922], 
[-0.00164903721451658, 0.0216346959217691, -0.999764582593641], 
[-0.00170319559901923, 0.023372512982547, -0.99972537467128], 
[-0.00184880567581299, 0.0247297906146494, -0.999692462397176], 
[-0.00203629297949422, 0.0257671493495592, -0.99966589795056], 
[-0.00226189499285155, 0.0264886845598127, -0.999646554248717], 
[-0.00252139476991818, 0.0268708726361911, -0.999635733040883], 
[-0.00278853775426807, 0.0269088551398548, -0.99963400180879], 
[-0.00305275483839364, 0.0265999669001261, -0.99964149696219], 
[-0.00328370401542298, 0.0259429903207621, -0.999658030799111], 
[-0.00347264076326944, 0.0249463334238261, -0.999682760286901], 
[-0.00360915565624783, 0.023594975196545, -0.999715084982178], 
[-0.00366876065455233, 0.0218981212636044, -0.999753475853115], 
[-0.00367619014862172, 0.0199864616897295, -0.999793492164815], 
[-0.00368313375937179, 0.0180783576201773, -0.999829789269887], 
[-0.0036815282765033, 0.016159433972755, -0.999862650089116], 
[-0.00368009637497761, 0.0142304767973127, -0.999891969375088], 
[-0.00367886000861645, 0.0122897818021977, -0.999917710240343], 
[-0.00367000088208702, 0.0103481384022852, -0.999939721745832], 
[-0.00366795273914187, 0.00840895384820267, -0.999957916923448], 
[-0.00366524026293572, 0.00647064229925123, -0.999972348018709], 
[-0.00366227360480787, 0.0045297859293121, -0.999983034251821], 
[-0.00366712667606644, 0.00258631011764451, -0.999989931540272], 
[-0.00366289586505909, 0.000642772610890319, -0.999993084994718], 
[-0.00366453652294986, -0.00130101110694854, -0.999992439242503], 
[-0.00366490238137529, -0.00324215359876794, -0.999988028393629], 
[-0.00366089506158248, -0.00518192787189393, -0.999979872532882], 
[-0.00366001332705879, -0.00711968082545663, -0.999967956710308], 
[-0.00365939839192361, -0.00906159236132507, -0.99995224703347], 
[-0.00365978532312834, -0.0110062001027489, -0.999932732502885], 
[-0.00365853161185282, -0.0129501809105263, -0.999909449880753], 
[-0.00365564345543876, -0.0148860114367343, -0.999882514565802], 
[-0.00365521691048981, -0.0168223159622663, -0.999851813557891], 
[-0.00365035252776038, -0.0187644600192866, -0.999817268287865], 
[-0.00364279518431618, -0.0207139511619934, -0.999778806672008], 
[-0.00365589614762306, -0.0226157796313967, -0.999737546026467], 
[-0.00373273643194803, -0.0242671602233794, -0.999698540367756], 
[-0.00387865751673048, -0.0255317673699299, -0.999666486819897], 
[-0.00407738788280039, -0.0264916248849668, -0.999640719818379], 
[-0.00431010975040509, -0.0271344942637205, -0.999622499834308], 
[-0.00456792595592772, -0.0274367503595764, -0.999613104547038], 
[-0.00483528558020711, -0.0273855879169237, -0.999613250006122], 
[-0.00509475314816266, -0.026986871213324, -0.999622804998203], 
[-0.00532410412193783, -0.0262442223698244, -0.999641383050693], 
[-0.00550705599367618, -0.0251565318377564, -0.999668355626094], 
[-0.00560834201336991, -0.0236314194420862, -0.999705007747292], 
[-0.00567421936569678, -0.0219505247307092, -0.999742955813461], 
[-0.00567850943795019, -0.0200223640408069, -0.99978340627797], 
[-0.00568980413699465, -0.0181171046522976, -0.999819682066672], 
[-0.00569349355191152, -0.0161864517803692, -0.999852780618195], 
[-0.00569506829989279, -0.0142561706766753, -0.999882156953857], 
[-0.00570130663196996, -0.0123222330455523, -0.999907824589577], 
[-0.00570246417681145, -0.0103859132678527, -0.999929804890276], 
[-0.00570547050920686, -0.00844240870193092, -0.999948085323222], 
[-0.00570667845700334, -0.00650086957129498, -0.999962585557982], 
[-0.00570682896325808, -0.00455600056933401, -0.999973337125544], 
[-0.0057079812100575, -0.00261422259982432, -0.999980292201153], 
[-0.00570964137260598, -0.000673216511428911, -0.999983473250896], 
[-0.00570813476435532, 0.00126917232159239, -0.999982903053412], 
[-0.00570779256583456, 0.00320952356759601, -0.999978559801406], 
[-0.00571099329707413, 0.00515040831882538, -0.999970428487618], 
[-0.00571584235701315, 0.00708919737089606, -0.999958535353735], 
[-0.0057198745332196, 0.00902895410937587, -0.999942878880096], 
[-0.00571665090449822, 0.010966646387281, -0.999923523360388], 
[-0.00571399058336989, 0.0129071499893429, -0.999900372932607], 
[-0.00571742812483056, 0.0148470447782978, -0.999873430128528], 
[-0.00571467453508848, 0.0167890149260053, -0.999842723368417], 
[-0.00572010238916287, 0.0187348529577097, -0.999808124448542], 
[-0.00572015630020732, 0.0206769268619975, -0.999769845768237], 
[-0.00572205490839957, 0.022536342092851, -0.999729649141556], 
[-0.00572098244384408, 0.0239750543206534, -0.999696187414056], 
[-0.00571964015518763, 0.0249062753886874, -0.999673428256827], 
[-0.00572747696858634, 0.0254729044876738, -0.999659105467727], 
[-0.00572643390524814, 0.0257516055458542, -0.999651970821115], 
[-0.00572603404441175, 0.0257610087800171, -0.999651730834673], 
[-0.00572525564766024, 0.0255247551782042, -0.999657795608508], 
[-0.00572062437239264, 0.0251368228004923, -0.99966765207057], 
[-0.00571990643592194, 0.0246016717489183, -0.999680969318474], 
[-0.00572047976854618, 0.0239944442254909, -0.999695725087152], 
[-0.00572097059300765, 0.0233653168896228, -0.999710624361931], 
[-0.00572138707390436, 0.0227629150942978, -0.999724519768501], 
[-0.00572008872449977, 0.0222376960791548, -0.999736347972842], 
[-0.00571105988352959, 0.0218438287868555, -0.999745082978125], 
[-0.00570632773379789, 0.0216330405658729, -0.999749693363129], 
[-0.0057083221158857, 0.0216005184633322, -0.999750385176588], 
[-0.00571097339707789, 0.0215884794393019, -0.999750630076499], 
[-0.00571544598276116, 0.0215288363253998, -0.999751890662725], 
[-0.0057169942807744, 0.0215190164358463, -0.999752093225129], 
[-0.00572110041370326, 0.0215363425679656, -0.999751696652149], 
[-0.00571567982583379, 0.0215513159115242, -0.999751404993566], 
[-0.00571560589507528, 0.0215556103427949, -0.999751312833348], 
[-0.00571969920903162, 0.0215580170107476, -0.999751237530378], 
[-0.00572262976494569, 0.0215600258991424, -0.999751177439568], 
[-0.00571361628654869, 0.0215598431443065, -0.999751232933735], 
[-0.00571261109991462, 0.0215579649138734, -0.999751279180574], 
[-0.00571579162148868, 0.0215554717553241, -0.999751314759598], 
[-0.00571781472623843, 0.0215571538748872, -0.999751266921713], 
[-0.00572129051427326, 0.0215605667533812, -0.999751173440734], 
[-0.00571696822992962, 0.0215604250098899, -0.99975120122341], 
[-0.00570478602507617, 0.0215580596327293, -0.999751321820221], 
[-0.0056892900879942, 0.0215576852966084, -0.999751418195017], 
[-0.00566507727690907, 0.0215587562015197, -0.99975153259722], 
[-0.00562320421028098, 0.0215582174479301, -0.999751780611006], 
[-0.00556683711372461, 0.0215553970468206, -0.999752156878245], 
[-0.00548860748619992, 0.0215518812474879, -0.99975266521403], 
[-0.00539448123810433, 0.0215473792185082, -0.999753274573775], 
]
    elif filename == "20161121_000420_0p1a_LNO_1":
        return [[-0.0058053408499231, 0.00579885248570252, -0.99996633509707], 
[-0.00581766865682429, 0.00580754116315128, -0.999966213027739], 
[-0.00582354374429152, 0.00581299120001577, -0.999966147162776], 
[-0.00582577017178014, 0.00581665092590679, -0.999966112912788], 
[-0.00582659528923694, 0.00581813066481787, -0.999966099496829], 
[-0.00585030212670417, 0.00581490660896559, -0.999965979834392], 
[-0.00597159780078903, 0.00581583682825271, -0.999965257427323], 
[-0.00616585113425558, 0.00581549343513761, -0.999964080512843], 
[-0.0063739710585809, 0.0058172758145603, -0.999962765204306], 
[-0.00658498986840759, 0.00582207833204873, -0.999961369910022], 
[-0.00679797889370654, 0.00581938956231405, -0.999959960292452], 
[-0.00701561310486908, 0.00581976174938429, -0.999958454909974], 
[-0.00721059673553205, 0.00581795086654152, -0.999957078450086], 
[-0.00737427857797121, 0.00581924751165455, -0.999955877213516], 
[-0.00748472694486404, 0.00581729808408185, -0.999955067943336], 
[-0.00752771878903998, 0.00581810084305176, -0.999954740551998], 
[-0.00750160753071619, 0.00581778704784514, -0.999954938603896], 
[-0.0073913984899776, 0.00581606900882214, -0.999955769306646], 
[-0.00718031408568683, 0.00581950050962231, -0.999957287339539], 
[-0.00683636236690293, 0.00582072816301914, -0.999959690824206], 
[-0.00635687006632148, 0.00581915201384687, -0.999962863146827], 
[-0.00576323292157434, 0.00581801662083089, -0.999966467352226], 
[-0.00509640196302543, 0.00582073048872933, -0.999970072443975], 
[-0.0044267135121221, 0.0058245945175225, -0.999973238795013], 
[-0.00376776388561932, 0.00581978802661402, -0.999975966722515], 
[-0.00308648769650677, 0.00580992556672704, -0.999978358945137], 
[-0.00240426335496225, 0.00581015929565634, -0.999980230587925], 
[-0.00172295346001553, 0.00581460505702894, -0.99998161073062], 
[-0.00104621390448433, 0.00581756054354557, -0.999982530560304], 
[-0.000368682531039825, 0.0058189383821305, -0.99998300187018], 
[0.000310686027789882, 0.00581872482380495, -0.999983022813696], 
[0.000993826574484587, 0.0058242222289682, -0.999982545219749], 
[0.00167784332202581, 0.00582531589517963, -0.999981625099436], 
[0.00235381575536584, 0.00581933580522445, -0.999980297246989], 
[0.00302381461607943, 0.00581584564479847, -0.999978516011521], 
[0.00370277524329333, 0.00581367225323347, -0.999976245053066], 
[0.00438975099306635, 0.00581436596722272, -0.999973461265157], 
[0.00507714590757645, 0.00582060629177877, -0.999970171121034], 
[0.00575368695179955, 0.00581846252006614, -0.999966519729717], 
[0.00637755208229458, 0.00579011699461689, -0.999962899999108], 
[0.00690952445401497, 0.00572528571447099, -0.999959738977179], 
[0.00732121106635279, 0.00561787043661969, -0.99995741879356], 
[0.00764170890122671, 0.00548909518160268, -0.999955736079931], 
[0.00786826051845544, 0.00535005270666122, -0.99995473268166], 
[0.00797861581339773, 0.00518346509192841, -0.999954735665242], 
[0.0079802882442195, 0.00500723960821066, -0.999955620290743], 
[0.00787730352014305, 0.00484439089516213, -0.999957239068805], 
[0.00767600321040153, 0.00469530045638957, -0.999959515744682], 
[0.00736464817526236, 0.00456284820963612, -0.999962470482503], 
[0.00694141157119711, 0.00446293327295626, -0.999965948936263], 
[0.00640649768893243, 0.00440051035521371, -0.999969795691838], 
[0.0057878184840438, 0.00437425739581395, -0.999973683168428], 
[0.0051236763194931, 0.00437066451281439, -0.999977322359207], 
[0.00444693328747481, 0.00437070398031224, -0.999980560676583], 
[0.00377866033226452, 0.0043669537210637, -0.999983325581628], 
[0.00310854084597405, 0.00436104173440943, -0.999985659041568], 
[0.00242537714566932, 0.00435747194430059, -0.999987564914662], 
[0.00174109250724676, 0.00435733328635999, -0.999988991061158], 
[0.00106514018955881, 0.00435806667519712, -0.999989936314977], 
[0.000357494094935425, 0.00437211056358371, -0.999990378377308], 
[-0.000320746963996013, 0.00437039082940571, -0.999990398356596], 
[-0.000983973965245325, 0.00436389957085764, -0.999989994037826], 
[-0.00166360318801259, 0.00436026252277173, -0.999989110208289], 
[-0.00234816654984563, 0.00435833678833987, -0.99998774543206], 
[-0.00302636536721954, 0.00436115165024147, -0.999985910635219], 
[-0.00370019809336131, 0.00435893863546389, -0.999983653960425], 
[-0.00438402188388871, 0.00435882394765539, -0.999980890320368], 
[-0.0050747768250946, 0.0043651076393351, -0.999977595986766], 
[-0.00574719124970851, 0.00436119924495894, -0.99997397452828], 
[-0.00637499464481919, 0.00433713251945469, -0.999970273920574], 
[-0.00691207852023484, 0.00427603162346501, -0.999966968816513], 
[-0.00733291777975078, 0.00416896465549153, -0.999964423392421], 
[-0.00764458442214998, 0.00403465048407988, -0.999962640264367], 
[-0.00786656755211891, 0.003885536942249, -0.999961509118035], 
[-0.00798086550270527, 0.00372365670209144, -0.999961219331326], 
[-0.00799601160792963, 0.00354496329166086, -0.999961747785197], 
[-0.00788682744819085, 0.00338327736274103, -0.999963175015505], 
[-0.00768218962149515, 0.00323511883926514, -0.999965258380868], 
[-0.00737446856190233, 0.00311023273562625, -0.999967971319962], 
[-0.00695031092638128, 0.00300981806992027, -0.99997131667524], 
[-0.0064187616704299, 0.00294918261811179, -0.999975050599015], 
[-0.00580551426302316, 0.00292122121335104, -0.999978881012376], 
[-0.00514061674837737, 0.00291094828748011, -0.999982550067507], 
[-0.00446376944430297, 0.00290912611121241, -0.999985805773071], 
[-0.0037912517623403, 0.00290291535107285, -0.999988599681286], 
[-0.00311628479899786, 0.00289799875093331, -0.99999094514515], 
[-0.00243217595708285, 0.00290047924189065, -0.999992835844478], 
[-0.00174659913874255, 0.00290486135756391, -0.999994255569472], 
[-0.0010663573273191, 0.00290348079905749, -0.999995216329208], 
[-0.000379093208676784, 0.00290615570336126, -0.999995705264461], 
[0.000318860341772244, 0.00291532016431045, -0.999995699608964], 
[0.000988884602128044, 0.00291274238734448, -0.999995269008323], 
[0.0016633336871622, 0.002911994866246, -0.999994376787662], 
[0.00234547344464568, 0.00290987189663749, -0.999993015675542], 
[0.00302245523125167, 0.00290992421401096, -0.999991198513989], 
[0.00370171117945763, 0.00290826680638351, -0.999988919597876], 
[0.00438420528700025, 0.0029066415354663, -0.999986164993789], 
[0.00507064226829373, 0.00290830743174112, -0.999982915021487], 
[0.00574940345758625, 0.00290705942648514, -0.999979246467332], 
[0.0063717725921065, 0.00288336371611942, -0.999975543064787], 
[0.00690676689414015, 0.00281792768904031, -0.99997217754026], 
[0.00733578130057171, 0.00271197652668672, -0.999969415280302], 
[0.0076440814224325, 0.00258049025181685, -0.999967454015013], 
[0.00786464633760875, 0.00242715269533256, -0.999966127560218], 
[0.00798902690434502, 0.0022638387924605, -0.999965524647247], 
[0.00799652185141561, 0.00209940942962867, -0.999965823475146], 
[0.00790263231773417, 0.00194162394001564, -0.999966888701284], 
[0.00769559621342226, 0.00179581832332427, -0.999968775930263], 
[0.00738278087363871, 0.00165923106907983, -0.999971370339587], 
[0.0069654521399609, 0.00155529213017895, -0.999974531447114], 
[0.0064335453669938, 0.00149032454276988, -0.999978193975633], 
[0.00581404533264565, 0.00146407004368956, -0.999982026526366], 
[0.00515220696014934, 0.00145776608288048, -0.999985664737994], 
[0.00447476336934881, 0.00145708194360861, -0.999988926641189], 
[0.00380365029531223, 0.00145326447642112, -0.999991710099035], 
[0.00312865362025079, 0.00144929761476128, -0.999994055513806], 
[0.00244591417295481, 0.00144810411784981, -0.999995960241001], 
[0.00175600611205492, 0.00145053533226206, -0.999997406191528], 
[0.00106655918338888, 0.00145265953939602, -0.999998376114567], 
[0.00038784627338242, 0.00144929467413339, -0.999998874559475], 
[-0.000292963263826073, 0.00145097410511243, -0.999998904422736], 
[-0.000970979771094582, 0.00145268733386904, -0.999998473447732], 
[-0.00162866209801017, 0.00144018805340885, -0.999997636656278], 
[-0.00232906052587623, 0.00144019748077353, -0.999996250647113], 
[-0.00303081206388809, 0.00144815264431111, -0.999994358500163], 
[-0.0037149739343738, 0.00145300664684507, -0.999992043838525], 
[-0.00440205546617278, 0.00145655126262974, -0.999989250125266], 
[-0.0050900900623628, 0.00145834163086842, -0.99998598201317], 
[-0.00576298117014797, 0.001450517663898, -0.999982341867365], 
[-0.00638689210026768, 0.00142710735755902, -0.999978585257649], 
[-0.00691958177143976, 0.00136413521608686, -0.999975128952326], 
[-0.00734024226130881, 0.00125861876951954, -0.999972267976637], 
[-0.00765485801340121, 0.00112519558298003, -0.999970068093888], 
[-0.00787702209326428, 0.000974947471635028, -0.999968500504076], 
[-0.00799660146799495, 0.000821927891766525, -0.999967688877747], 
[-0.00800134974953507, 0.000654621724977468, -0.999967774417047], 
[-0.00789519035173372, 0.000491772909661764, -0.999968711574875], 
[-0.00768264523813741, 0.000349457809423581, -0.999970426983411], 
[-0.00738424959090118, 0.000214367759142121, -0.999972713079934], 
[-0.00696861945800172, 0.000105521178449364, -0.999975713309144], 
[-0.00643691719479762, 3.91299356714614E-05, -0.999979282068321], 
[-0.00581676760627828, 1.11887883641352E-05, -0.99998308240161], 
[-0.00515109411360252, 3.50717285944108E-06, -0.99998673302056], 
[-0.00447823525242822, 2.71061659524848E-06, -0.999989972650564], 
[-0.00380601385114499, -2.96983890178018E-07, -0.999992757103009], 
[-0.00313509754220205, -5.81962342772077E-06, -0.99999508555269], 
[-0.00245655938016639, -6.89575591553772E-06, -0.999996982629678], 
[-0.00176888428575624, -7.09624240814057E-06, -0.99999843549779], 
[-0.00108117561160816, -4.14895382196619E-06, -0.999999415520871], 
[-0.000395185744709945, -4.07713761382206E-06, -0.999999921905799], 
[0.000288746737130677, -7.11063737665888E-06, -0.99999995828738], 
[0.000974063185176363, -6.32326897760406E-06, -0.999999525580351], 
[0.0016446974578184, -7.96111190730954E-06, -0.999998647452532], 
[0.00232832075943007, -9.96961249711823E-06, -0.99999728940785], 
[0.00302279429573749, -8.03039440680708E-06, -0.999995431314643], 
[0.00370882488560691, -7.82653758895492E-06, -0.999993122254705], 
[0.00439423370322871, -3.23333930354888E-06, -0.999990345303247], 
[0.00508496220472677, 2.84246991861125E-06, -0.999987071492075], 
[0.00576112418787592, 5.79782443422666E-06, -0.999983404569534], 
[0.00638073329433942, -0.000025835900409453, -0.999979642580354], 
[0.00691155068489738, -9.52469081703994E-05, -0.999976110412222], 
[0.00733796490819006, -0.000201140181346456, -0.999973056543842], 
[0.0076584855780266, -0.000335363152827179, -0.999970617133427], 
[0.0078765231538826, -0.000487312949856512, -0.999968860969728], 
[0.00799464444665101, -0.000644267538974361, -0.999967834772454], 
[0.00801178765884824, -0.000808400805074755, -0.999967578347742], 
[0.00790658300358627, -0.000971937205048471, -0.999968270138246], 
[0.00770266022590058, -0.00112123649782103, -0.999969705468201], 
[0.00739251758257178, -0.00125507613853094, -0.999971887338678], 
[0.00697449398382073, -0.0013688117000195, -0.999974741075093], 
[0.00643994863362137, -0.00143003957945076, -0.999978240787467], 
[0.00581705988845516, -0.00144541111475232, -0.999982036139132], 
[0.00515515621299861, -0.00144290109230014, -0.99998567109777], 
[0.00448210989939271, -0.0014468197620511, -0.999988908640204], 
[0.00381083284929399, -0.0014493477406848, -0.99999168843752], 
[0.00313439164013265, -0.00145311313811119, -0.999994032007818], 
[0.00245350558924996, -0.00145578440497904, -0.999995930492764], 
[0.00176926825420642, -0.001453300384603, -0.999997378800483], 
[0.001083572596118, -0.00144883685147155, -0.999998363369764], 
[0.00039274138165927, -0.00144853917516627, -0.999998873743598], 
[-0.000295502179998116, -0.00144983599044972, -0.999998905326432], 
[-0.000977787862855102, -0.00145040078000982, -0.999998470133066], 
[-0.00166063304589001, -0.0014496737863891, -0.999997570368948], 
[-0.00234270090904779, -0.00145323738887707, -0.999996199919551], 
[-0.0030250206725655, -0.00146059556202164, -0.999994357939351], 
[-0.00371003626130265, -0.00146238923049857, -0.999992048492726], 
[-0.00439611773820484, -0.00146015311060553, -0.999989270993307], 
[-0.00508069423130876, -0.00145321597786593, -0.999986037257246], 
[-0.00575480226476075, -0.00145265582845455, -0.99998238586584], 
[-0.00639010975269578, -0.00147645768590973, -0.999978493053751], 
[-0.00691376687828219, -0.00154907905914856, -0.9999748997758], 
[-0.00730495341769637, -0.00166400661554029, -0.999971933974923], 
[-0.00763325218000847, -0.00179671073696091, -0.999969252173128], 
[-0.00787800100015488, -0.00194079596810855, -0.999967084663916], 
[-0.00800033352713054, -0.00209437493370931, -0.999965803543847], 
[-0.00800433187936004, -0.00225794687392598, -0.999965415575499], 
[-0.00790786496367745, -0.0024172335345785, -0.999965810742425], 
[-0.00770716483557386, -0.00257066944476473, -0.99996699508974], 
[-0.00739291860495974, -0.00270434497571601, -0.999969015156346], 
[-0.00696945783729515, -0.00280450072958865, -0.999971780318381], 
[-0.00644438935528925, -0.00286773245021848, -0.999975122668775], 
[-0.00583105790623182, -0.00289266188822015, -0.999978815411054], 
[-0.00516235572194007, -0.00289804868514173, -0.999982475545056], 
[-0.00448621551639254, -0.00290217234222582, -0.999985725531138], 
[-0.00381956752553674, -0.00291007268252003, -0.999988471123993], 
[-0.00314525776910619, -0.00291308906827564, -0.9999908105906], 
[-0.00245372723452544, -0.00290961510652402, -0.999992756655062], 
[-0.00178870610757278, -0.00292144858449953, -0.999994132817102], 
[-0.00110327292762985, -0.00292376898529822, -0.999995117169963], 
[-0.000404580268097359, -0.00291854113805282, -0.999995659206795], 
[0.000282641533434152, -0.00291333905769667, -0.999995716275474], 
[0.000970551192395997, -0.0029135169555756, -0.999995284713549], 
[0.00166008778180323, -0.00291111030342678, -0.999994384756914], 
[0.00234415180220387, -0.00291092606760718, -0.999993015706488], 
[0.00302256414304294, -0.00291405309211954, -0.999991186161447], 
[0.00370604829476688, -0.00291267525098602, -0.999988890702751], 
[0.00439391202271584, -0.00290754626787086, -0.999986119759588], 
[0.00509061245564126, -0.00291030889451599, -0.999982807735695], 
[0.00576749170495426, -0.00291299080459058, -0.999979125044121], 
[0.00639215226326745, -0.00293312880112743, -0.99997526826661], 
[0.00692742143442577, -0.00299388285416164, -0.999971523343403], 
[0.00734658016704351, -0.00310385948147867, -0.99996819640235], 
[0.00765962045846875, -0.00324283810062383, -0.999965406509388], 
[0.00788331533158236, -0.00339397926919022, -0.999963166443696], 
[0.0079886285830701, -0.00356332951756787, -0.9999617415162], 
[0.00799537083599977, -0.00373230020769628, -0.999961071232453], 
[0.00789879369899839, -0.0038838630800587, -0.999961261582506], 
[0.00770357462170664, -0.0040259531184643, -0.999962222606202], 
[0.00740352237404816, -0.00415905907114942, -0.999963944392046], 
[0.00698487790916425, -0.0042629439237766, -0.999966518834354], 
[0.00644990085693326, -0.00432656996246982, -0.999969839330815], 
[0.00582781910217788, -0.00434497209116556, -0.999973578521972], 
[0.0051586415847783, -0.00434445208292243, -0.999977256817923], 
[0.00448103263853442, -0.00434979485312108, -0.999980499625482], 
[0.00381086600009773, -0.00435668084601449, -0.999983248175856], 
[0.00314046289387232, -0.00436523007323622, -0.999985541025079], 
[0.00245499034294333, -0.00436721410964754, -0.999987450152919], 
[0.00176483000478452, -0.00436043857079001, -0.999988935914055], 
[0.00108746430432856, -0.00436178019952329, -0.999989896096395], 
[0.000373592318869661, -0.00435027393663537, -0.999990467727296], 
[-0.000310500374223042, -0.0043428867142798, -0.99999052141733], 
[-0.000973753667717567, -0.00435602732964881, -0.999990038365232], 
[-0.0016545199306222, -0.00436302118834425, -0.999989113245694], 
[-0.00234116105589654, -0.00436426737807811, -0.999987735992378], 
[-0.00301901702318006, -0.00436536452014437, -0.999985914465209], 
[-0.00369820593276191, -0.0043674243146532, -0.999983624304786], 
[-0.00438465594406009, -0.00436532225288897, -0.999980859193755], 
[-0.00507772141497933, -0.00436059427053573, -0.999977600730556], 
[-0.00576019101461863, -0.0043610037049681, -0.99997390058249], 
[-0.0063871768808507, -0.00438767187668576, -0.999969975702768], 
[-0.00691667373315447, -0.004454493082083, -0.999966157985284], 
[-0.00733558726333258, -0.00456405602102171, -0.999962678579625], 
[-0.0076518043068138, -0.00469981581712563, -0.999959679998216], 
[-0.00788277456320904, -0.00484667357318167, -0.999957184893664], 
[-0.00800024323304881, -0.00500879516481818, -0.999955453047389], 
[-0.00801532032740854, -0.00518591491799252, -0.999954429424917], 
[-0.00790857200753203, -0.0053436933897377, -0.999954448677418], 
[-0.00770336640221462, -0.00548684730476705, -0.999955275326215], 
[-0.00739606031553874, -0.0056169049155223, -0.999956873405538], 
[-0.00697302330890446, -0.00571207921795666, -0.999959373723224], 
[-0.00644258846455205, -0.00577148372228532, -0.999962590815036], 
[-0.0058281948358499, -0.00579922969893576, -0.999966199968706], 
[-0.0051641741322382, -0.00581061381284854, -0.999969783579809], 
[-0.00448687666616109, -0.00581876733311977, -0.999973004577877], 
[-0.00381178651407497, -0.00582336533246155, -0.999975779056561], 
[-0.00313562285241354, -0.00582573445016733, -0.999978114104226], 
[-0.00245236141584328, -0.00582379023176041, -0.999980034496101], 
[-0.00176174039031505, -0.00581804136196452, -0.999981523162057], 
[-0.00107674684349992, -0.00581753551835521, -0.999982498295209], 
[-0.000389748219057687, -0.00581405004642187, -0.999983022315071], 
[0.000303729963425159, -0.00580761088047642, -0.999983089559004], 
[0.000979662350368143, -0.00581021414348555, -0.99998264068597], 
[0.00165866047431562, -0.00581290667073413, -0.999981729313825], 
[0.00234855734353757, -0.00581246312358792, -0.999980349582351], 
[0.00302784441763274, -0.00581563144810647, -0.999978505063505], 
[0.00370060623126149, -0.00581709336417916, -0.999976233186726], 
[0.00438511161132111, -0.00581897854025328, -0.999973454790128], 
[0.00507885973945865, -0.00582104799285096, -0.999970159846788], 
[0.00575511887554785, -0.00582243077143275, -0.999966488391806], 
[0.0063614527991058, -0.00582068597611568, -0.999962825075539], 
[0.00683143310684718, -0.00581965155079521, -0.999959730777962], 
[0.0071576413635049, -0.00582198164025683, -0.999957435444075], 
[0.00738521647660674, -0.00582673135003939, -0.999955752910782], 
[0.00750224320129911, -0.00582592353727707, -0.999954886463328], 
[0.00753538625692938, -0.00582623297969824, -0.999954635452642], 
[0.00750503961615177, -0.00582356876862955, -0.999954879195635], 
[0.00740818396444304, -0.00582048449527818, -0.999955619400476], 
[0.00726034605751341, -0.00581943892982821, -0.999956709815814], 
[0.00707374160957167, -0.00581630891079465, -0.999958065485896], 
[0.00686286848302674, -0.00581360377494145, -0.999959550705594], 
[0.00663796805170976, -0.00581484325923084, -0.999961061730913], 
[0.00641869416281415, -0.00581664263255048, -0.999962482813095], 
[0.00622048689032981, -0.0058181460397698, -0.999963726701877], 
[0.00606072770361033, -0.00581940414363555, -0.999964700434528], 
[0.00594778841063395, -0.00581610268791268, -0.999965397782616], 
[0.0058861896790157, -0.00581384271493312, -0.999965775416313], 
[0.00586625163487983, -0.00581172929138844, -0.999965904865961], 
[0.00586393520661393, -0.00581246005783209, -0.999965914205064], 
[0.00586045993214462, -0.00581248446132939, -0.999965934436654], 
[0.00584530763225893, -0.00581308006021047, -0.999966019662117], 
]

    elif filename == "20161121_021920_0p1a_LNO_1":
        return [[-0.00580407904416828, 0.00581089849982926, -0.999966272493765], 
[-0.00581072220123177, 0.00581402335212901, -0.999966215749293], 
[-0.00581529323965512, 0.00581665257869143, -0.999966173886555], 
[-0.00581565538803759, 0.00581776539931719, -0.99996616530669], 
[-0.00581499189905123, 0.00581996815503389, -0.999966156347248], 
[-0.00581354552271887, 0.00583962462456221, -0.999966050160054], 
[-0.00581411291597915, 0.00594789577124793, -0.999965408715169], 
[-0.0058143348319512, 0.00613883496253539, -0.999964253468975], 
[-0.00581761040276172, 0.00635096688010056, -0.999962909626597], 
[-0.00581881074787516, 0.0065663271386857, -0.999961511654018], 
[-0.00582534254907101, 0.0067880497078388, -0.999959993082398], 
[-0.00582531066761038, 0.00700563726786587, -0.999958492539614], 
[-0.00582264428847142, 0.00720316107846327, -0.999957104721981], 
[-0.00582360661698163, 0.00736521091714569, -0.999955918665476], 
[-0.00582020427592636, 0.00747286988659336, -0.9999551397127], 
[-0.00582112964270367, 0.00752085602413817, -0.999954774564503], 
[-0.00582150411851388, 0.00749840355237887, -0.999954941001825], 
[-0.00582096074171512, 0.00738832595225646, -0.999955763549402], 
[-0.00582143547305353, 0.00717375847364292, -0.99995732312854], 
[-0.00582133517508719, 0.00682406953806398, -0.999959771256684], 
[-0.00582159485681247, 0.00635989230018393, -0.999962829710811], 
[-0.00581819688189637, 0.00576609820926367, -0.999966449785434], 
[-0.00581238006074573, 0.0050957014848529, -0.999970124585933], 
[-0.00580805822445867, 0.00442487174032088, -0.999973343129577], 
[-0.00581113751010685, 0.00376379470278394, -0.999976031977904], 
[-0.00580925439816313, 0.00308404713680176, -0.999978370374377], 
[-0.00581371892130896, 0.0024093960576466, -0.999980197545402], 
[-0.00581948754468479, 0.00173450320563515, -0.9999815623617], 
[-0.00581662635218444, 0.00105576141706617, -0.999982525960184], 
[-0.00581554627742074, 0.000378109960257594, -0.999983018082984], 
[-0.00581614524116681, -0.000303228223024964, -0.99998304010977], 
[-0.00581753860517432, -0.000984601500749899, -0.999982593250734], 
[-0.00581907769261495, -0.00166845013564821, -0.999981677136612], 
[-0.00581773347679235, -0.00234969151587542, -0.999980316269762], 
[-0.00581434025821454, -0.00302773407551137, -0.999978512906017], 
[-0.00581839537181007, -0.00370610721435348, -0.999976205239211], 
[-0.00581860245538572, -0.00439016104708528, -0.999973434822869], 
[-0.00581712047554569, -0.0050799502005473, -0.999970177162966], 
[-0.00581327055062903, -0.00575828739375236, -0.999966523445558], 
[-0.00578944941654363, -0.00637955109062676, -0.999962891113133], 
[-0.00572396867616171, -0.0069069502636893, -0.999959764300869], 
[-0.00561245583096053, -0.00731630210487155, -0.999957485127771], 
[-0.00548377649422565, -0.00763286369355164, -0.999955832818229], 
[-0.00534933970890463, -0.00784920082589994, -0.999954886287913], 
[-0.00518112002015211, -0.00796202828778586, -0.999954880032535], 
[-0.00501236731722973, -0.00796288045406656, -0.999955733374609], 
[-0.00485214327674928, -0.0078593836833225, -0.999957342487038], 
[-0.00469747146589133, -0.00766046407920815, -0.999959624710877], 
[-0.00456183549222804, -0.0073549894496775, -0.999962546192175], 
[-0.00446047771280997, -0.00693397119427873, -0.999966011513417], 
[-0.00439932972823729, -0.0064004889865973, -0.999969839364505], 
[-0.00437763823390787, -0.00578048643231961, -0.999973710784488], 
[-0.00437109960847991, -0.00511252659016244, -0.999977377524151], 
[-0.00436757073829253, -0.00443557556777937, -0.999980624809915], 
[-0.0043633868044961, -0.0037703143224622, -0.999983372654518], 
[-0.00436174158178086, -0.00310698202308012, -0.999985660833735], 
[-0.00436262941136355, -0.00242566198582551, -0.999987541736671], 
[-0.0043632551318182, -0.00173868402160287, -0.999988969430427], 
[-0.00436183627802657, -0.0010623587528231, -0.999989922838307], 
[-0.00437516464106462, -0.000352213347858094, -0.999990366893662], 
[-0.00437544350727788, 0.000336724289228032, -0.999990371009075], 
[-0.00436573281753423, 0.000998815495359239, -0.999989971321999], 
[-0.00435881100929109, 0.00166539416004125, -0.999989113555181], 
[-0.00436038415315757, 0.00234852750545336, -0.999987735659089], 
[-0.00436001358041204, 0.00302422446295727, -0.999985922074894], 
[-0.00435863394937344, 0.00369884818987315, -0.999983660282589], 
[-0.00436020396355918, 0.00438065270824758, -0.9999808990692], 
[-0.00436477994029146, 0.00507123873331, -0.999977615366355], 
[-0.00435753383978454, 0.00574536759423915, -0.999974000987047], 
[-0.00433028666938405, 0.00636965105942657, -0.999970337641443], 
[-0.00426545399862581, 0.00690221414302893, -0.999967082129262], 
[-0.00416299864463227, 0.00732325470940777, -0.999964519061925], 
[-0.0040320677834645, 0.00763469165589894, -0.999962726261689], 
[-0.00388389664632841, 0.00785355290983879, -0.999961617790169], 
[-0.00371567589417675, 0.00796710912140187, -0.999961358715874], 
[-0.00354393009524352, 0.0079756429138088, -0.999961914114529], 
[-0.00339138812789638, 0.00787143418048393, -0.999963268830665], 
[-0.00324341806051631, 0.00766694564013923, -0.999965348491554], 
[-0.00310968122211818, 0.00735839300126056, -0.999968091458491], 
[-0.00300910388195594, 0.00693654088258113, -0.999971414438639], 
[-0.00294887359717515, 0.00640328873636489, -0.99997515071019], 
[-0.0029219101767799, 0.00578326369547257, -0.99997900793064], 
[-0.00290761327593271, 0.00512241062180846, -0.999982653196774], 
[-0.00290745356380129, 0.00445014775821279, -0.999985871349543], 
[-0.00290719935379268, 0.00377977304400046, -0.999988630689196], 
[-0.00290350012583779, 0.00310853797055131, -0.999990953298431], 
[-0.00290323119212895, 0.00243047136362926, -0.999992832003108], 
[-0.00290407186579969, 0.00174513073986331, -0.999994260426178], 
[-0.00290592627173955, 0.00106330383907271, -0.999995212477264], 
[-0.00291157943510913, 0.000380123045303214, -0.99999568909654], 
[-0.00292028181703728, -0.000313969049888043, -0.99999568667947], 
[-0.00291317752564055, -0.000987797787658944, -0.999995268814925], 
[-0.00290919689514822, -0.00166484800039059, -0.999994382411502], 
[-0.00290542332367988, -0.00234776666210274, -0.999993023229168], 
[-0.00290407017475459, -0.00302604601669048, -0.999991204672284], 
[-0.00290313901314436, -0.0037047980401511, -0.999988923066327], 
[-0.00290908120558614, -0.00438702195133278, -0.999986145546496], 
[-0.00291092682511982, -0.00507627084636939, -0.99998287884309], 
[-0.00290276909938075, -0.00575248090059578, -0.999979241232059], 
[-0.00287694524084168, -0.00637300852924734, -0.999975553675372], 
[-0.00281526991154858, -0.00690516370360053, -0.999972196098247], 
[-0.00270683950998053, -0.00732820211109551, -0.999969484771254], 
[-0.00257323118570312, -0.00763375571882698, -0.999967551600996], 
[-0.0024280151686961, -0.00784448474679377, -0.999966283832309], 
[-0.00226904609342365, -0.00795193465504223, -0.999965808498005], 
[-0.0021019045629516, -0.00796274765447458, -0.999966087748479], 
[-0.00194474888905499, -0.00787612010149093, -0.999967091800478], 
[-0.00179400750510263, -0.00767537443195034, -0.999968934599671], 
[-0.00165344453496199, -0.00736953346331244, -0.999971477642089], 
[-0.00154604382906226, -0.00695553911338654, -0.999974614789856], 
[-0.00148896376522293, -0.00641601030221009, -0.999978308664097], 
[-0.00147029208567945, -0.00579511986861991, -0.999982127253728], 
[-0.00146139844863549, -0.00512732395160002, -0.999985787330835], 
[-0.00146251134469294, -0.00444927398112041, -0.99998903245066], 
[-0.00146097588916031, -0.00378298634062657, -0.999991777248092], 
[-0.00145864445458734, -0.00311279115373407, -0.999994091426339], 
[-0.00145861156881118, -0.00243758958028962, -0.999995965296525], 
[-0.00145833230794851, -0.00175690940301693, -0.999997393264717], 
[-0.00145523433064794, -0.00106884111531212, -0.999998369934528], 
[-0.00145276602852913, -0.000387443633756067, -0.99999886967851], 
[-0.00145012598917532, 0.000296754983364975, -0.999998904534948], 
[-0.00144938050318048, 0.000978882239067619, -0.99999847054169], 
[-0.00143265239564524, 0.00162808021673914, -0.999997648428196], 
[-0.00144075880601246, 0.0023166753165339, -0.999996278607846], 
[-0.00145022447952064, 0.00302071450242308, -0.999994386050669], 
[-0.00145072268614101, 0.00370560370533275, -0.999992081921086], 
[-0.00145102030447648, 0.00438984637534486, -0.99998931183732], 
[-0.00145855220760692, 0.0050813573400118, -0.999986026118886], 
[-0.00145594686160241, 0.00575855653740281, -0.999982359467077], 
[-0.00142919650033518, 0.00638204612539605, -0.999978613213611], 
[-0.00136235987664183, 0.00691078530705699, -0.99997519220329], 
[-0.00125628132038325, 0.00732784684247888, -0.999972361827014], 
[-0.00112468845478583, 0.00764452535805598, -0.999970147708385], 
[-0.000974726645981638, 0.00786449317136437, -0.999968599334561], 
[-0.000816578960161361, 0.00797562708976508, -0.999967860769198], 
[-0.000650091662427034, 0.00797873890184411, -0.99996795803984], 
[-0.000485745151767679, 0.00787573554723165, -0.999968867936016], 
[-0.000346721422963164, 0.00766390930386905, -0.999970571706206], 
[-0.000212157239778591, 0.00736131143857613, -0.99997288267393], 
[-0.000102398846574411, 0.00694725978325369, -0.999975862256675], 
[-3.88776857296782E-05, 0.00641506527634155, -0.999979422501296], 
[-1.13766350212571E-05, 0.00579531981846632, -0.999983206928383], 
[-2.45090044469973E-06, 0.0051292321302829, -0.999986845399352], 
[1.2884974092084E-06, 0.00445953200513895, -0.999990056236878], 
[4.46688157193747E-06, 0.00379126951798872, -0.999992813101919], 
[8.70296657366759E-06, 0.00312209166508206, -0.99999512622207], 
[6.35110599366977E-06, 0.00244587202925735, -0.999997008830366], 
[4.50490021751597E-06, 0.00176002863619931, -0.999998451138253], 
[2.62455053433387E-06, 0.00107192437206757, -0.999999425485461], 
[3.15019381968036E-06, 0.00038931049838213, -0.999999924213703], 
[1.68934088098741E-06, -0.00028979002082591, -0.999999958009444], 
[-4.66810542038737E-07, -0.000972844325742944, -0.999999526786738], 
[4.92313353797408E-06, -0.0016488016131621, -0.999998640713578], 
[9.47422742217299E-06, -0.00232588142948182, -0.999997295089249], 
[4.28317924702837E-06, -0.00301479253230408, -0.999995455493495], 
[1.37223023082014E-06, -0.00370174045140844, -0.999993148534402], 
[-1.90322581744364E-06, -0.00439015292802582, -0.999990363230389], 
[-7.52278980698347E-06, -0.00508014189854405, -0.999987095967592], 
[-1.37579577484955E-06, -0.00575574539720075, -0.999983435559325], 
[3.16059250319703E-05, -0.0063773104413878, -0.999979664249528], 
[9.77324602890079E-05, -0.00691035885559043, -0.999976118409261], 
[0.000204733247779747, -0.00733285136539963, -0.99997309332559], 
[0.000334653200377546, -0.00764283022936788, -0.999970737148503], 
[0.000484089437759847, -0.00785346263490098, -0.99996904391189], 
[0.000638387017851025, -0.00796908945856669, -0.999968042526968], 
[0.000801556391866937, -0.00798095108266225, -0.999967830446143], 
[0.000970313441299698, -0.00787655147971313, -0.999968508718456], 
[0.00112093839575563, -0.00767463217384093, -0.999969921306691], 
[0.00125204755126772, -0.00736702774980758, -0.999972079249747], 
[0.00136843177269445, -0.0069537585794408, -0.999974886002695], 
[0.00142711783886199, -0.0064227344206386, -0.99997835567438], 
[0.00144696851062586, -0.00579599343649713, -0.999982156211906], 
[0.00144563689749964, -0.00513345272173193, -0.999985778797436], 
[0.00144566083914589, -0.00445758946124008, -0.999989019920186], 
[0.00144772182676445, -0.00378371330090829, -0.999991793773913], 
[0.00144784126539397, -0.00311298074381524, -0.999994106535913], 
[0.00144916495048172, -0.00243806919905042, -0.999995977861675], 
[0.00145610822784487, -0.00175976845794068, -0.999997391478499], 
[0.00145684225567246, -0.00107682961694256, -0.999998359022963], 
[0.00145288545252945, -0.000390274227514858, -0.999998868404304], 
[0.00145205990961929, 0.000294896868893474, -0.999998902278325], 
[0.00145168542254528, 0.00097814783746124, -0.999998467916947], 
[0.00145437968668204, 0.00165895107774419, -0.999997566327563], 
[0.00145668104757352, 0.00233759786461512, -0.999996206851081], 
[0.00145184013411106, 0.00302104839289921, -0.999994382697639], 
[0.0014545768434544, 0.00370558309031921, -0.999992076398692], 
[0.0014558604074768, 0.00439212888353405, -0.999989294779871], 
[0.00145581751134524, 0.00507321757492441, -0.999986071432403], 
[0.00145882736869767, 0.00574569692650191, -0.999982429240403], 
[0.00147845221840635, 0.00638099724245382, -0.999978548296527], 
[0.00155482836310568, 0.00688722743333435, -0.999975073992869], 
[0.00166675606878207, 0.00729319769722843, -0.999972015204204], 
[0.00179238384993129, 0.00761360720158485, -0.999969409704874], 
[0.00193321618280507, 0.0078523504857734, -0.999967301098911], 
[0.0020894428911392, 0.0079745168465356, -0.999966020077417], 
[0.00225586400603275, 0.00798366945796674, -0.999965585457606], 
[0.00241900307414296, 0.00788571036021102, -0.999965981419489], 
[0.00257212827221597, 0.00768555852131342, -0.999967157633873], 
[0.00270707734326696, 0.00737724401860895, -0.999969123524795], 
[0.00281084523123353, 0.00695513783475923, -0.999971862207525], 
[0.00287201054212934, 0.00642490734725128, -0.999975235753879], 
[0.00289768522283585, 0.00579977523244422, -0.99997898279294], 
[0.0029018049059481, 0.00512697868062686, -0.999982646658379], 
[0.00290048591163767, 0.00445531218562261, -0.999985868587554], 
[0.00290989343847634, 0.0037950217721693, -0.999988565099584], 
[0.00291470654466993, 0.00312629224348679, -0.999990865349562], 
[0.00291426840440005, 0.00244291934751549, -0.999992769566225], 
[0.00292444767734069, 0.00178156173376795, -0.999994136804597], 
[0.00291930449851018, 0.00109809401094619, -0.999995135913564], 
[0.00290911338032898, 0.00040530330347309, -0.999995686384983], 
[0.00290782927157742, -0.000282971414821199, -0.999995732218946], 
[0.00290909719556201, -0.000968743622316859, -0.999995299333602], 
[0.00291034632359733, -0.00166078587119542, -0.999994385821524], 
[0.00290908313890922, -0.00234471679714345, -0.999993019744854], 
[0.00290881742871487, -0.00302479431040333, -0.999991194661506], 
[0.0029109479481052, -0.00370512388063571, -0.999988899157922], 
[0.00290997079636042, -0.0043911084376372, -0.999986125022069], 
[0.00290663128856922, -0.00507977015192079, -0.999982873568221], 
[0.00291010016098686, -0.00575480416046517, -0.99997920655688], 
[0.00293572595632255, -0.00637758728550661, -0.999975353643041], 
[0.00300274330540007, -0.00691102125046486, -0.99997161025597], 
[0.00311140108517364, -0.00733174396508446, -0.999968281853838], 
[0.00324187836157845, -0.00764368140191223, -0.999965531585622], 
[0.0033867332350141, -0.00786365914457398, -0.999963345779661], 
[0.00355718955679016, -0.00796692243552608, -0.999961936550269], 
[0.00372500432012281, -0.00796991223481187, -0.999961301672112], 
[0.00387970636040164, -0.00786853406134927, -0.999961516284643], 
[0.00402788814003594, -0.00766852347325271, -0.999962484228719], 
[0.00416096805738957, -0.00736663300887901, -0.999964208890967], 
[0.00426615838083209, -0.00695354333047789, -0.999966723510248], 
[0.00432893027541556, -0.00642445693789482, -0.999969992907649], 
[0.0043501993850783, -0.00580123397807742, -0.999973710379249], 
[0.00435362828311636, -0.00513707218178058, -0.999977327948075], 
[0.00435104629782584, -0.00446439051982533, -0.999980568617911], 
[0.00435283625992196, -0.00379633442535214, -0.999983320191605], 
[0.00435360231105634, -0.00312557725729306, -0.999985638353735], 
[0.00435983509550973, -0.00244747115330895, -0.999987500783332], 
[0.00436375597974499, -0.00175921879361842, -0.999988931330235], 
[0.00436356527843707, -0.00108068157259791, -0.999989895661651], 
[0.00435134897171424, -0.000371505976390628, -0.999990463827249], 
[0.00435322297640146, 0.000317690715276973, -0.999990474215793], 
[0.00436228848634776, 0.00098546005786271, -0.999989999603814], 
[0.00436672261794585, 0.00165950830697485, -0.999989088823352], 
[0.00436784424016704, 0.00234180172944174, -0.999987718875264], 
[0.00436448853697817, 0.00301827022606147, -0.999985920543211], 
[0.00436983279404525, 0.00369575233289207, -0.999983622853918], 
[0.00436940150287497, 0.00438168240529942, -0.999980854411626], 
[0.00436442838577186, 0.00507123653613329, -0.999977616911929], 
[0.00436590644767808, 0.00574656204512853, -0.999973957603673], 
[0.00439234678499066, 0.00637452032695787, -0.999970035941238], 
[0.00445593144389833, 0.00691034495024803, -0.99996619533244], 
[0.00455921998211279, 0.00732984510830393, -0.99996274274787], 
[0.00468872026706529, 0.00763962588377294, -0.999959825202299], 
[0.00483847011582514, 0.00785871146190669, -0.999957414023766], 
[0.00500956743754022, 0.00797943207782116, -0.999955615463909], 
[0.00518587093885782, 0.00798898087211148, -0.99995464043487], 
[0.00533576433107444, 0.00788082791544512, -0.999954710059596], 
[0.00547963245750998, 0.00767156747255502, -0.999955559352837], 
[0.00561660184493938, 0.00736305235598514, -0.999957118702456], 
[0.00571913026349623, 0.00694343584785074, -0.999959539305294], 
[0.00577865939751593, 0.0064192236687245, -0.999962699635871], 
[0.00580980215175189, 0.00579750648767124, -0.999966316991469], 
[0.00581247535462367, 0.00513367648359799, -0.999969929795898], 
[0.00581524644434781, 0.00445985474948402, -0.999973145941632], 
[0.00582295444562491, 0.00379062008102066, -0.999975861909139], 
[0.00582924965180393, 0.00312475568970812, -0.999978127635988], 
[0.00582579273464124, 0.00244615055108687, -0.999980038044007], 
[0.00581993886263388, 0.00175684323632984, -0.999981520735997], 
[0.00582056918474565, 0.00107634592631315, -0.99998248107345], 
[0.00581521395792958, 0.000383865840590228, -0.999983017822623], 
[0.00581263538623241, -0.000310213734209674, -0.999983058375143], 
[0.00581937165214328, -0.000988556103675076, -0.999982578683451], 
[0.00582341333242997, -0.00166588787968729, -0.999981656169118], 
[0.00582166103402371, -0.00234141956969538, -0.999980312814809], 
[0.00582331142049156, -0.00302217076389905, -0.999978477532379], 
[0.00581997205034711, -0.00370437216109818, -0.999976202492952], 
[0.00581649975355378, -0.0043908185005006, -0.99997344416915], 
[0.00581801051697741, -0.00508181464007913, -0.999970162511656], 
[0.00581697739270499, -0.00575474626006804, -0.999966522274368], 
[0.00581551842105993, -0.00635386570696867, -0.999962903379957], 
[0.00581902802771608, -0.00682369619098919, -0.99995978723302], 
[0.00582159524624997, -0.00714904028373369, -0.999957499222747], 
[0.00582051403087964, -0.00736847073064154, -0.999955912655907], 
[0.00582159276571346, -0.00748600834384158, -0.999955033357374], 
[0.00582098031507031, -0.00752196925414536, -0.999954767060346], 
[0.00582161386367145, -0.00748490276423768, -0.999955041510683], 
[0.00582029524378699, -0.00738364664102257, -0.999955801986046], 
[0.00581949390838545, -0.00722744272745105, -0.999956947854392], 
[0.00581553431894065, -0.00704348714098612, -0.999958283554609], 
[0.00581889538210516, -0.0068328543608654, -0.999959725467889], 
[0.00581734742751358, -0.00661409216493518, -0.999961205374359], 
[0.00581642631417293, -0.00639549647792772, -0.999962632706709], 
[0.00581257320003674, -0.00619684278107061, -0.999963905914779], 
[0.00581015549522305, -0.00603719613760879, -0.999964896561833], 
[0.00581409017813828, -0.00593110289830712, -0.999965508592077], 
[0.00581071116530139, -0.00587271629020578, -0.999965872837233], 
[0.005807675847128, -0.00585318207584513, -0.999966005002591], 
[0.00580681640005703, -0.00585115809306978, -0.999966021838875], 
[0.00580739579947363, -0.00584580013356962, -0.999966049811105], 
[0.0058058756256344, -0.00583122688065614, -0.999966143727519], 

]


def get_vector(date_time, reference_frame):
    # print("SUN", date_time, reference_frame, SPICE_ABERRATION_CORRECTION, SPICE_OBSERVER)
    obs2SunVector = sp.spkpos("SUN", date_time, reference_frame, SPICE_ABERRATION_CORRECTION, SPICE_OBSERVER)[0]
    obs2SunUnitVector = obs2SunVector / sp.vnorm(obs2SunVector)
    return -1 * obs2SunUnitVector #-1 is there to switch the directions to be like in cosmographia




if channel == "so":
    fig1, axes = plt.subplots(nrows=2, ncols=4, figsize=(FIG_X+5, FIG_Y+2), sharex=True, )
    axes = axes.flatten()
else:
    fig1, ax = plt.subplots(nrows=1, ncols=1, figsize=(FIG_X, FIG_Y))


fig1.add_subplot(111, frameon=False)
plt.tick_params(labelcolor='none', top=False, bottom=False, left=False, right=False)
plt.xlabel("%s FRAME X" %referenceFrame)
plt.ylabel("%s FRAME Y" %referenceFrame)
for linescan_index, (title, hdf5_filenames) in enumerate(linescan_dict[channel].items()):

    xs = []
    ys = []
    zs = []
    
    if channel == "so":
        ax = axes[linescan_index]

    for scan_index, hdf5_filename in enumerate(hdf5_filenames):

        
        try:
            hdf5_file = open_hdf5_file(hdf5_filename)
        except OSError:
            get_files_from_datastore([hdf5_filename])
            hdf5_file = open_hdf5_file(hdf5_filename)

        detector_centre_line = DETECTOR_CENTRE_LINES[channel]


        detector_data_all = hdf5_file["Science/Y"][...]
        datetime_all = hdf5_file["Geometry/ObservationDateTime"][...]
        window_top_all = hdf5_file["Channel/WindowTop"][...]
        window_height = hdf5_file["Channel/WindowHeight"][0]+1
        binning = hdf5_file["Channel/Binning"][0]+1
        sbsf = hdf5_file["Channel/BackgroundSubtraction"][0]

        if binning==2: #stretch array
            detector_data_all=np.repeat(detector_data_all,2,axis=1)
            detector_data_all /= 2
        if binning==4: #stretch array
            detector_data_all=np.repeat(detector_data_all,4,axis=1)
            detector_data_all /= 4
            
        if sbsf == 0:
            detector_data_all -= 50000.0
    
        #convert data to times and boresights using spice
        et_all=np.asfarray([np.mean([utc2et(i[0]), utc2et(i[1])]) for i in datetime_all])

        #find which window top contains the line
        unique_window_tops = list(set(window_top_all))
        for unique_window_top in unique_window_tops:
            if unique_window_top <= detector_centre_line <= (unique_window_top + window_height):
                centre_window_top = unique_window_top
                centre_row_index = detector_centre_line - unique_window_top
    
        window_top_indices = np.where(window_top_all == centre_window_top)[0]
        detector_data_line = detector_data_all[window_top_indices, centre_row_index, :]
        et_line = et_all[window_top_indices]
    
        detector_line_mean = np.mean(detector_data_line[:, 160:240], axis=1)
        detector_line_min = (np.max(detector_line_mean) + np.min(detector_line_mean)) * 0.65
        detector_line_max = np.max(detector_line_mean)
        detector_line_mean[detector_line_mean < detector_line_min] = detector_line_min
        detector_line_mean[detector_line_mean > detector_line_max] = detector_line_max

        
        print("%s: max value = %0.0f, min value = %0.0f" %(hdf5_filename, np.max(detector_line_mean), np.min(detector_line_mean)))
        if hdf5_filename in ["20160615_233950_0p1a_LNO_1", "20160616_015450_0p1a_LNO_1", "20161121_000420_0p1a_LNO_1", "20161121_021920_0p1a_LNO_1"]:
            unitVectors = np.asfarray(get_vector_text(hdf5_filename))
        else:
            unitVectors = np.asfarray([get_vector(datetime,referenceFrame) for datetime in et_line])
#        marker_colour = np.log(detector_line_mean)
        marker_colour = detector_line_mean
        
        if not MESHGRID:
            ax.scatter(unitVectors[:,0], unitVectors[:,1], c=marker_colour, alpha=1, cmap="gnuplot", linewidths=0)


        
        xs.extend(unitVectors[:,0])
        ys.extend(unitVectors[:,1])
        zs.extend(marker_colour)

    if not MESHGRID:
        circle1 = plt.Circle((0, 0), 0.0016, color='yellow', alpha=0.1)
        ax.add_artist(circle1)
    ax.set_xlim([-0.004,0.004])
    ax.set_ylim([-0.004,0.004])
    ax.set_aspect("equal")
    ax.set_title("%s: %s & %s" %(title, hdf5_filenames[0][:8], hdf5_filenames[1][:8]))
    ax.set_title("%s" %(title))
    ax.grid()

        
    if MESHGRID:
        
        """plot interpolation"""

        xs = np.asfarray(xs)
        ys = np.asfarray(ys)
        zs = np.asfarray(zs)
        
        # Create grid values first.
        ngridx = 100
        ngridy = 100
        xi = np.linspace(-0.004, 0.004, ngridx)
        yi = np.linspace(-0.004, 0.004, ngridy)
        
        # Linearly interpolate the data (x, y) on a grid defined by (xi, yi).
        import matplotlib.tri as tri
        triang = tri.Triangulation(xs, ys)
        interpolator = tri.LinearTriInterpolator(triang, zs)
        Xi, Yi = np.meshgrid(xi, yi)
        zi = interpolator(Xi, Yi)
        
        ax.contourf(xi, yi, zi, levels=50, cmap="gnuplot")


fig1.tight_layout()
plt.savefig("%s_linescan_boresight.png" %channel, dpi=300)
#fig1.suptitle("SO Linescans")



